@inject CsvParsingService Csv
@inherits WizardStepBase
@using Models

<FileUploadComponent T="Dictionary<int,Student>" 
                     PText="Selecteer het .csv bestand met alle studenten." 
                     H3Text="Studentenlijst" 
                     Parser="ParseStudents"
                     AssignResult="AssignStudents"
                     GoToNextStep="GoToNextStep"/>

@code {
    protected override Task OnInitializedAsync()
    {
        return base.OnInitializedAsync();
    }

    private async Task<Dictionary<int, Student>> ParseStudents(Stream stream)
    {
        return await Csv.ParseStudents(stream).ToDictionaryAsync(s => s.StudentNumber);
    }

    private void AssignStudents(Dictionary<int, Student> students)
    {
        Wiz.WizardModel.Students = students;
    }
}
