@inject CsvParsingService Csv
@inherits WizardStepBase
@using Models

<FileUploadComponent T="Dictionary<int,Student>" 
                     PText="Select the .csv file with all the students information." 
                     H3Text="Student list" 
                     Parser="ParseStudents"
                     AssignResult="AssignStudents"
                     GoToNextStep="GoToNextStep"/>

@code {
    protected override void OnInitialized()
    {
        base.OnInitialized();
    }

    private async Task<Dictionary<int, Student>> ParseStudents(Stream stream)
    {
        return await Csv.ParseStudents(stream).ToDictionaryAsync(s => s.StudentNumber);
    }

    private void AssignStudents(Dictionary<int, Student> students)
    {
        Wiz.WizardModel.Students = students;
    }
}
